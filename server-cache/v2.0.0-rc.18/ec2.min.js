window.AWS.EC2=window.AWS.Service.defineService("ec2");window.AWS.util.update(window.AWS.EC2.prototype,{setupRequestListeners:function r(e){e.removeListener("extractError",window.AWS.EventListeners.Query.EXTRACT_ERROR);e.addListener("extractError",this.extractError);if(e.operation==="copySnapshot"){e.onAsync("validate",this.buildCopySnapshotPresignedUrl)}},buildCopySnapshotPresignedUrl:function e(r,o){if(r.params.PresignedUrl||r._subRequest){return o()}r.params=window.AWS.util.copy(r.params);r.params.DestinationRegion=r.service.config.region;var i=window.AWS.util.copy(r.service.config);delete i.endpoint;i.region=r.params.SourceRegion;i.signatureVersion="v4";var n=new r.service.constructor(i);var s=n[r.operation](r.params);s._subRequest=true;s.presign(function(e,i){if(e)o(e);else{r.params.PresignedUrl=i;o()}})},extractError:function o(r){var e=r.httpResponse;var o=new window.AWS.XML.Parser({}).parse(e.body.toString()||"");if(o.Errors)r.error=window.AWS.util.error(new Error,{code:o.Errors.Error.Code,message:o.Errors.Error.Message});else r.error=window.AWS.util.error(new Error,{code:e.statusCode,message:null})}});